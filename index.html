<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Learner AI</title>

<script src="https://cdn.tailwindcss.com"></script>

<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18",
    "react-dom/client": "https://esm.sh/react-dom@18/client",
    "@google/genai": "https://esm.sh/@google/genai"
  }
}
</script>
</head>

<body class="bg-stone-100">
<div id="root"></div>

<script type="module">
import React, { useState } from "react";
import { createRoot } from "react-dom/client";
import { GoogleGenAI, Type } from "@google/genai";

const API_KEY = "YOUR_API_KEY_HERE";

const ai = new GoogleGenAI({ apiKey: API_KEY });

async function generateContent(prompt, systemInstruction, schema) {
  const response = await ai.models.generateContent({
    model: "gemini-1.5-flash",
    contents: prompt,
    config: {
      systemInstruction,
      responseMimeType: "application/json",
      responseSchema: schema
    }
  });
  return JSON.parse(response.text);
}

function App() {
  const modes = ["essay","ad","letter","notice","debate","speech","invitation","passage"];
  const [mode,setMode] = useState("essay");
  const [input,setInput] = useState("");
  const [result,setResult] = useState(null);
  const [loading,setLoading] = useState(false);

  async function run() {
    setLoading(true);
    let schema = {
      type: Type.OBJECT,
      properties: {
        title:{type:Type.STRING},
        content:{type:Type.STRING}
      },
      required:["title","content"]
    };

    let system = "Write well formatted content.";

    if(mode==="debate"){
      schema = {
        type:Type.OBJECT,
        properties:{
          topic:{type:Type.STRING},
          positives:{type:Type.ARRAY,items:{type:Type.STRING}},
          negatives:{type:Type.ARRAY,items:{type:Type.STRING}}
        },
        required:["topic","positives","negatives"]
      };
      system="Give 5 pros and 5 cons";
    }

    const res = await generateContent(input,system,schema);
    setResult(res);
    setLoading(false);
  }

  return (
    <div className="max-w-3xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-4 text-center">Learner AI</h1>

      <div className="flex flex-wrap gap-2 justify-center mb-6">
        {modes.map(m=>(
          <button key={m}
            onClick={()=>{setMode(m);setResult(null)}}
            className={`px-4 py-2 rounded ${mode===m?"bg-black text-white":"bg-white"}`}>
            {m.toUpperCase()}
          </button>
        ))}
      </div>

      {!result && (
        <>
          <textarea
            className="w-full p-3 border rounded mb-4"
            rows="4"
            placeholder="Enter topic..."
            value={input}
            onChange={e=>setInput(e.target.value)}
          ></textarea>

          <button onClick={run} className="w-full bg-black text-white py-3 rounded">
            Generate
          </button>
        </>
      )}

      {loading && <p className="mt-4 text-center">Loading...</p>}

      {result && (
        <div className="mt-6 bg-white p-6 rounded shadow">
          {mode==="debate" ? (
            <>
              <h2 className="font-bold text-xl mb-2">{result.topic}</h2>
              <h3 className="font-bold">Pros</h3>
              <ul>{result.positives.map((p,i)=><li key={i}>• {p}</li>)}</ul>
              <h3 className="font-bold mt-2">Cons</h3>
              <ul>{result.negatives.map((n,i)=><li key={i}>• {n}</li>)}</ul>
            </>
          ) : (
            <>
              <h2 className="text-xl font-bold mb-2">{result.title}</h2>
              <p className="whitespace-pre-wrap">{result.content}</p>
            </>
          )}

          <button onClick={()=>setResult(null)} className="mt-4 text-sm text-blue-600">
            ← Back
          </button>
        </div>
      )}
    </div>
  );
}

const root = createRoot(document.getElementById("root"));
root.render(<App />);
</script>

</body>
</html>
